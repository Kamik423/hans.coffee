<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="url" content="https://hans.coffee/blog/subl-on-wsl"/><title>Hans Schülein · How to Open Sublime Text From Windows Subsystem for Linux Version 2</title><meta name="description" content="Hans Schülein"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/icon.png" type="image/png"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Hans Schülein"/><meta name="twitter:image" content="https://hans.coffee/icon.svg"/><meta name="og:image" content="https://hans.coffee/icon.svg"/></head><body><header><a href="/" class="site-name">Hans Schülein</a><span><a href="mailto:Hans%20Schülein<mail@hans.coffee>"><img src="/icons/mail.png" alt="Mail" class="icon"/></a><a href="https://mastodon.social/@SherlockHans" rel="me"><img src="/icons/mastodon.png" alt="Mastodon" class="icon"/></a><a href="https://github.com/Kamik423"><img src="/icons/github.png" alt="GitHub" class="icon"/></a></span></header><main><article><a href="/" class="home-link">← Return to homepage</a><a href="/blog" class="home-link">← All posts</a><h1>How to Open Sublime Text From Windows Subsystem for Linux Version 2</h1><span class="post-date">August 30, 2023</span><p>In my current workflow for my day-job, I frequently find myself using my preferred shell <a href="http://fishshell.com">fish</a> through the Windows Subsystem for Linux version 2 – or <abbr><span class='real-caps'>WSL</span><span class='small-caps' hidden>wsl</span></abbr> 2 – to do operations on files in the Windows file system. One of my most common operations is that I want to open a file in my preferred editor – Sublime Text. When just using the regular shell in any operating system, Sublime Text provides the shell command <code>subl</code> that opens Sublime Text. I now want to open the Windows application from the Linux shell to open a file on Windows. Microsoft even provides a <code>wslpath</code> utility that can translate a path in the <abbr><span class='real-caps'>WSL</span><span class='small-caps' hidden>wsl</span></abbr> into a true Windows one or the other way round. A factor that adds additional complexity to this task is <code>subl</code> having command line arguments that I might want to use:</p><div class="highlight"><pre><span></span><code>Sublime Text build 4152

Usage: subl [arguments] [files]         Edit the given files
   or: subl [arguments] [directories]   Open the given directories
   or: subl [arguments] -- [files]      Edit files that may start with &#39;-&#39;
   or: subl [arguments] -               Edit stdin
   or: subl [arguments] - &gt;out          Edit stdin and write the edit to stdout

Arguments:
  --project &lt;project&gt;:    Load the given project
  --command &lt;command&gt;:    Run the given command
  -n or --new-window:     Open a new window
  --launch-or-new-window: Only open a new window if the application is open
  -a or --add:            Add folders to the current window
  -w or --wait:           Wait for the files to be closed before returning
  -b or --background:     Don&#39;t activate the application
  -s or --stay:           Keep the application activated after closing the file
  --safe-mode:            Launch using a sandboxed (clean) environment
  -h or --help:           Show help (this message) and exit
  -v or --version:        Show version and exit

--wait is implied if reading from stdin. Use --stay to not switch back
to the terminal when a file is closed (only relevant if waiting for a file).

Filenames may be given a :line or :line:column suffix to open at a specific
location.
</code></pre></div><p>I especially care about the <code>--wait</code> flag, since this enables me to use Sublime Text as an editor, for example for setting git commit messages. Additionally it needs to be considered that if the <code>--help</code> flag is used, usually no path is added as argument.</p><p>I then whipped up this quick Python script. It passes on arguments that look like flags (starting with a <code>-</code>) to Windows’ <code>subl</code> and assumes that any other one is a path and translates it to a Windows one.</p><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># The path to the Sublime Text Windows executable in the Linxu file-system.</span>
<span class="n">SUBL</span> <span class="o">=</span> <span class="s2">&quot;/mnt/c/Program Files/Sublime Text/subl.exe&quot;</span>


<span class="k">def</span> <span class="nf">window_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1"># Convert a Linux path to a Windows one so Sublime Text understands it.</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;wslpath -aw &quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">(</span>
            <span class="n">returncode</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">returncode</span><span class="p">,</span> <span class="n">cmd</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span>
        <span class="p">)</span>
    <span class="c1"># Somehow  only understands paths using slashes instead of backslashes</span>
    <span class="c1"># as you would expect from a Windows command line utility. So we replace all</span>
    <span class="c1"># of the backslashes with regular slashes. Afterwards spaces in the path are</span>
    <span class="c1"># escaped so  understands any path as a single argument, not multiple.</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2"> &quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Execute the command on the Linux command line. Any argument beginning with</span>
    <span class="c1"># a  is passed on directly to  (like  or ). However any</span>
    <span class="c1"># other argument is converted to a Windows path from a Linux one.</span>
    <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;exec &quot;</span><span class="si">{</span><span class="n">SUBL</span><span class="si">}</span><span class="s1">&quot; &#39;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">arg</span> <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">window_path</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
    <span class="p">)</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="c1"># Print any output of  like help text or errors.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Pass through the return code</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div><p>I placed this file in <abbr><span class='real-caps'>WSL</span><span class='small-caps' hidden>wsl</span></abbr>’s <code>/usr/local/bin/</code> directory, named it <code>subl</code> (without any extension) and marked it as executable using</p><div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chmod<span class="w"> </span>a+x<span class="w"> </span>subl
</code></pre></div><p>Linux knows to execute this file with Python 3 since it starts with the <a href="https://en.wikipedia.org/wiki/Shebang_%28Unix%29">shebang line</a> marking it as such. The utility passes on the exit code of <code>subl.exe</code> to <abbr><span class='real-caps'>WSL</span><span class='small-caps' hidden>wsl</span></abbr>. Any paths on the Windows side of the <abbr><span class='real-caps'>VM</span><span class='small-caps' hidden>vm</span></abbr> divide are easily understood. Paths that refer to files or directories on the Linux side use <code>\\wsl.localhost\Debian\</code> as the root directory. This mounts the <abbr><span class='real-caps'>WSL</span><span class='small-caps' hidden>wsl</span></abbr> 2 file system on Windows.</p><p>As a result this means that even temporary files on the Linux side, like git commit messages can be edited. You can even use fish’s <code>funced</code> command to edit functions with Sublime Text. to simplify the process, I set my <code>$EDITOR</code> environment variable to <code>sublw</code> which refers to another little script I put in the <code>/usr/local/bin</code> directory:</p><div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
subl<span class="w"> </span>-w<span class="w"> </span>
</code></pre></div><p>This uses the <code>-w</code> or <code>--wait</code> flag to only exit from the call once Sublime Text is closed again, i.e., after a user has edited and saved the file. Without this flag, the <code>subl</code> command would immediately return once the file is <em>opened</em> in Sublime Text.</p><p>With the <code>subl</code> and potentially the <code>sublw</code> utility you can now easily use Sublime Text on Windows from the Windows Subsystem for Linux. You should be able to just copy the code above or copy it from <a href="https://gist.github.com/Kamik423/80ebcef8d0308aa80307291394b19f5d">this GitHub gist</a>.</p><a href="/blog" class="home-link">← All posts</a><a href="/" class="home-link">← Return to homepage</a></article></main><footer><span><a href="/colophon">Colophon</a> · <a href="/feed.rss"><abbr><span class='real-caps'>RSS</span><span class='small-caps' hidden>rss</span></abbr> feed</a></span><span><a href="/impressum" class="badlink">Impressum</a> · <a href="/privacy" class="badlink">Privacy</a></span></footer></body></html>